{"ast":null,"code":"/*eslint-disable*/\nimport BaseLayout from '@/layouts/BaseLayout.vue';\nimport ProductColorList from '@/components/Product/ProductColorList.vue';\nimport ProductImage from '@/components/Product/ProductImage.vue';\nimport noPhoto from '@/assets/img/noPhoto.png';\nimport numberFormat from '@/helpers/numberFormat';\nimport { mapState, mapActions } from 'vuex';\nimport ProductCounter from '@/components/Product/ProductCounter.vue';\nexport default {\n  components: {\n    BaseLayout,\n    ProductCounter,\n    ProductColorList,\n    ProductImage\n  },\n  filters: {\n    numberFormat\n  },\n  data() {\n    return {\n      currentSizeId: 0,\n      currentColor: null,\n      currentImage: null,\n      quantity: 1,\n      incorrectSize: false\n    };\n  },\n  computed: {\n    ...mapState('products', ['product']),\n    ...mapState('cart', ['productAddSending', 'cartAddingFailed', 'productAdded', 'open', 'cartError', 'cartErrorMessage']),\n    sizes() {\n      return this.product ? this.product.sizes : [];\n    }\n  },\n  watch: {\n    '$route.params.id': {\n      handler() {\n        this.loadProduct({\n          id: this.$route.params.id\n        }).catch(() => {\n          this.$router.replace('/notFound');\n        });\n      },\n      immediate: true\n    },\n    currentSizeId: {\n      handler() {\n        return this.currentSizeId <= 0;\n      }\n    },\n    product: {\n      handler() {\n        this.currentColor = this.product.colors[0].color;\n        this.currentImage = this.product.colors[0].gallery ? this.product.colors[0].gallery[0].file.url : noPhoto;\n      }\n    },\n    currentColor: {\n      handler(value) {\n        if (value.color) this.currentColor = value.color;\n        if (typeof value.gallery !== 'undefined') {\n          if (value.gallery) {\n            this.currentImage = value.gallery[0].file.url;\n          } else {\n            this.currentImage = noPhoto;\n          }\n        }\n      }\n    },\n    currentImage: {\n      handler(value) {\n        if (typeof value.gallery !== 'undefined') {\n          if (value.gallery) {\n            this.currentImage = value.gallery[0].file.url;\n          } else {\n            this.currentImage = noPhoto;\n          }\n        }\n        if (value.color) this.currentColor = value.color;\n      }\n    }\n  },\n  methods: {\n    ...mapActions('products', ['loadProduct']),\n    ...mapActions('cart', ['addProductToCart', 'closeModal', 'openModal']),\n    addToCart() {\n      this.incorrectSize = false;\n      if (this.currentSizeId > 0) {\n        this.addProductToCart({\n          productId: this.product.id,\n          colorId: this.currentColor,\n          sizeId: this.currentSizeId,\n          quantity: this.quantity\n        });\n      } else {\n        this.incorrectSize = true;\n      }\n      this.openModal();\n    }\n  }\n};","map":{"version":3,"names":["BaseLayout","ProductColorList","ProductImage","noPhoto","numberFormat","mapState","mapActions","ProductCounter","components","filters","data","currentSizeId","currentColor","currentImage","quantity","incorrectSize","computed","sizes","product","watch","handler","loadProduct","id","$route","params","catch","$router","replace","immediate","colors","color","gallery","file","url","value","methods","addToCart","addProductToCart","productId","colorId","sizeId","openModal"],"sources":["src/pages/ProductPage.vue"],"sourcesContent":["<template>\n  <!-- eslint-disable  -->\n  <BaseLayout>\n    <div>\n      <main class=\"content container\" v-if=\"!product\">\n        <div style=\"text-align:center;\">\n          <h2>\n            Не удалось загрузить товар.\n          </h2>\n        </div>\n      </main>\n      <main class=\"content container\" v-else>\n        <div class=\"content__top\">\n          <ul class=\"breadcrumbs\">\n            <li class=\"breadcrumbs__item\">\n              <router-link class=\"breadcrumbs__link\" :to=\"{ name: 'main' }\">\n                Каталог\n              </router-link>\n            </li>\n            <!-- <li class=\"breadcrumbs__item\">\n              <router-link class=\"breadcrumbs__link\" :to=\"{ name: 'main' }\">\n                {{ product.category.title }}\n              </router-link>\n            </li> -->\n            <li class=\"breadcrumbs__item\">\n              <a class=\"breadcrumbs__link\">\n                {{ product.title }}\n              </a>\n            </li>\n          </ul>\n        </div>\n\n        <section class=\"item\">\n          <div class=\"item__pics pics\">\n            <div class=\"pics__wrapper\">\n              <img :src=\"currentImage\" :alt=\"currentImage\" />\n            </div>\n            <ProductImage :images=\"product.colors\" :currentImage.sync=\"currentImage\" />\n          </div>\n\n          <div class=\"item__info\">\n            <span class=\"item__code\">Артикул: {{ product.id }}</span>\n            <h2 class=\"item__title\">\n              {{ product.title }}\n            </h2>\n            <div class=\"item__form\">\n              <form class=\"form\" action=\"#\" method=\"POST\" @submit.prevent=\"addToCart\">\n                <div class=\"item__row item__row--center\">\n                  <!-- dda -->\n                  <ProductCounter :quantity.sync=\"quantity\" :productId=\"this.product.id\" />\n\n                  <b class=\"item__price\"> {{ product.price | numberFormat }} ₽ </b>\n                </div>\n\n                <div class=\"item__row\">\n                  <fieldset class=\"form__block\">\n                    <legend class=\"form__legend\">Цвет</legend>\n\n                    <ProductColorList :colors=\"product.colors\" :currentColor.sync=\"currentColor\" />\n                  </fieldset>\n\n                  <fieldset class=\"form__block\">\n                    <legend class=\"form__legend\">Размер</legend>\n                    <label class=\"form__label form__label--small form__label--select\">\n                      <select class=\"form__select\" type=\"text\" name=\"size\" v-model.number=\"currentSizeId\">\n                        <option value=\"0\">Выберите размер</option>\n                        <option :value=\"size.id\" v-for=\"size in sizes\" :key=\"size.id\">\n                          {{ size.title }}\n                        </option>\n                      </select>\n                    </label>\n                  </fieldset>\n                </div>\n\n                <button class=\"button button--primery\" type=\"submit\" :disabled=\"quantity === 0\">\n                  В корзину\n                </button>\n\n                <vue-modaltor :visible=\"open\" @hide=\"closeModal\" :show-close-button=\"false\">\n                  <div class=\"cart__error form__error-block\" style=\"text-align:center;\">\n                    <h4 v-if=\"incorrectSize\">\n                      Выберите размер\n                    </h4>\n                    <h4 v-if=\"productAddSending\">\n                      Товар добавляется в корзину...\n                    </h4>\n                    <h4 v-if=\"productAdded\">\n                      Товар добавлен в корзину\n                    </h4>\n                    <h4 v-if=\"cartAddingFailed\">\n                      Ошибка!\n                    </h4>\n                    <p v-if=\"cartAddingFailed\">\n                      {{ cartErrorMessage }}\n                    </p>\n                  </div>\n                </vue-modaltor>\n              </form>\n            </div>\n          </div>\n\n          <div class=\"item__desc\">\n            <ul class=\"tabs\">\n              <li class=\"tabs__item\">\n                <a class=\"tabs__link tabs__link--current\">\n                  Информация о товаре\n                </a>\n              </li>\n              <li class=\"tabs__item\">\n                <a class=\"tabs__link\" href=\"#\">\n                  Доставка и возврат\n                </a>\n              </li>\n            </ul>\n\n            <div class=\"item__content\">\n              <h3>Состав:</h3>\n\n              <p>\n                60% хлопок<br />\n                30% полиэстер<br />\n              </p>\n\n              <h3>Уход:</h3>\n\n              <p>\n                Машинная стирка при макс. 30ºC короткий отжим<br />\n                Гладить при макс. 110ºC<br />\n                Не использовать машинную сушку<br />\n                Отбеливать запрещено<br />\n                Не подвергать химчистке<br />\n              </p>\n            </div>\n          </div>\n        </section>\n      </main>\n    </div>\n  </BaseLayout>\n</template>\n\n<script>\n/*eslint-disable*/\nimport BaseLayout from '@/layouts/BaseLayout.vue';\nimport ProductColorList from '@/components/Product/ProductColorList.vue';\nimport ProductImage from '@/components/Product/ProductImage.vue';\nimport noPhoto from '@/assets/img/noPhoto.png';\nimport numberFormat from '@/helpers/numberFormat';\nimport { mapState, mapActions } from 'vuex';\nimport ProductCounter from '@/components/Product/ProductCounter.vue';\n\nexport default {\n  components: { BaseLayout, ProductCounter, ProductColorList, ProductImage },\n  filters: {\n    numberFormat,\n  },\n  data() {\n    return {\n      currentSizeId: 0,\n      currentColor: null,\n      currentImage: null,\n      quantity: 1,\n      incorrectSize: false,\n    };\n  },\n  computed: {\n    ...mapState('products', [\n      'product',\n    ]),\n    ...mapState('cart', [\n      'productAddSending',\n      'cartAddingFailed',\n      'productAdded',\n      'open',\n      'cartError',\n      'cartErrorMessage',\n    ]),\n    sizes() {\n      return this.product ? this.product.sizes : [];\n    },\n  },\n  watch: {\n    '$route.params.id': {\n      handler() {\n        this.loadProduct({ id: this.$route.params.id }).catch(() => {\n          this.$router.replace('/notFound');\n        });\n      },\n      immediate: true,\n    },\n    currentSizeId: {\n      handler() {\n        return this.currentSizeId <= 0;\n      },\n    },\n    product: {\n      handler() {\n        this.currentColor = this.product.colors[0].color;\n        this.currentImage = this.product.colors[0].gallery\n          ? this.product.colors[0].gallery[0].file.url\n          : noPhoto;\n      },\n    },\n    currentColor: {\n      handler(value) {\n        if (value.color) this.currentColor = value.color;\n        if (typeof value.gallery !== 'undefined') {\n          if (value.gallery) {\n            this.currentImage = value.gallery[0].file.url;\n          } else {\n            this.currentImage = noPhoto;\n          }\n        }\n      },\n    },\n    currentImage: {\n      handler(value) {\n        if (typeof value.gallery !== 'undefined') {\n          if (value.gallery) {\n            this.currentImage = value.gallery[0].file.url;\n          } else {\n            this.currentImage = noPhoto;\n          }\n        }\n        if (value.color) this.currentColor = value.color;\n      },\n    },\n  },\n  methods: {\n    ...mapActions('products', ['loadProduct']),\n    ...mapActions('cart', [\n      'addProductToCart',\n      'closeModal',\n      'openModal',\n    ]),\n    addToCart() {\n      this.incorrectSize = false;\n      if (this.currentSizeId > 0) {\n        this.addProductToCart({\n          productId: this.product.id,\n          colorId: this.currentColor,\n          sizeId: this.currentSizeId,\n          quantity: this.quantity,\n        });\n      } else {\n        this.incorrectSize = true;\n      }\n      this.openModal();\n    },\n  },\n};\n</script>\n"],"mappings":"AA6IA;AACA,OAAAA,UAAA;AACA,OAAAC,gBAAA;AACA,OAAAC,YAAA;AACA,OAAAC,OAAA;AACA,OAAAC,YAAA;AACA,SAAAC,QAAA,EAAAC,UAAA;AACA,OAAAC,cAAA;AAEA;EACAC,UAAA;IAAAR,UAAA;IAAAO,cAAA;IAAAN,gBAAA;IAAAC;EAAA;EACAO,OAAA;IACAL;EACA;EACAM,KAAA;IACA;MACAC,aAAA;MACAC,YAAA;MACAC,YAAA;MACAC,QAAA;MACAC,aAAA;IACA;EACA;EACAC,QAAA;IACA,GAAAX,QAAA,cACA,UACA;IACA,GAAAA,QAAA,UACA,qBACA,oBACA,gBACA,QACA,aACA,mBACA;IACAY,MAAA;MACA,YAAAC,OAAA,QAAAA,OAAA,CAAAD,KAAA;IACA;EACA;EACAE,KAAA;IACA;MACAC,QAAA;QACA,KAAAC,WAAA;UAAAC,EAAA,OAAAC,MAAA,CAAAC,MAAA,CAAAF;QAAA,GAAAG,KAAA;UACA,KAAAC,OAAA,CAAAC,OAAA;QACA;MACA;MACAC,SAAA;IACA;IACAjB,aAAA;MACAS,QAAA;QACA,YAAAT,aAAA;MACA;IACA;IACAO,OAAA;MACAE,QAAA;QACA,KAAAR,YAAA,QAAAM,OAAA,CAAAW,MAAA,IAAAC,KAAA;QACA,KAAAjB,YAAA,QAAAK,OAAA,CAAAW,MAAA,IAAAE,OAAA,GACA,KAAAb,OAAA,CAAAW,MAAA,IAAAE,OAAA,IAAAC,IAAA,CAAAC,GAAA,GACA9B,OAAA;MACA;IACA;IACAS,YAAA;MACAQ,QAAAc,KAAA;QACA,IAAAA,KAAA,CAAAJ,KAAA,OAAAlB,YAAA,GAAAsB,KAAA,CAAAJ,KAAA;QACA,WAAAI,KAAA,CAAAH,OAAA;UACA,IAAAG,KAAA,CAAAH,OAAA;YACA,KAAAlB,YAAA,GAAAqB,KAAA,CAAAH,OAAA,IAAAC,IAAA,CAAAC,GAAA;UACA;YACA,KAAApB,YAAA,GAAAV,OAAA;UACA;QACA;MACA;IACA;IACAU,YAAA;MACAO,QAAAc,KAAA;QACA,WAAAA,KAAA,CAAAH,OAAA;UACA,IAAAG,KAAA,CAAAH,OAAA;YACA,KAAAlB,YAAA,GAAAqB,KAAA,CAAAH,OAAA,IAAAC,IAAA,CAAAC,GAAA;UACA;YACA,KAAApB,YAAA,GAAAV,OAAA;UACA;QACA;QACA,IAAA+B,KAAA,CAAAJ,KAAA,OAAAlB,YAAA,GAAAsB,KAAA,CAAAJ,KAAA;MACA;IACA;EACA;EACAK,OAAA;IACA,GAAA7B,UAAA;IACA,GAAAA,UAAA,UACA,oBACA,cACA,YACA;IACA8B,UAAA;MACA,KAAArB,aAAA;MACA,SAAAJ,aAAA;QACA,KAAA0B,gBAAA;UACAC,SAAA,OAAApB,OAAA,CAAAI,EAAA;UACAiB,OAAA,OAAA3B,YAAA;UACA4B,MAAA,OAAA7B,aAAA;UACAG,QAAA,OAAAA;QACA;MACA;QACA,KAAAC,aAAA;MACA;MACA,KAAA0B,SAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}