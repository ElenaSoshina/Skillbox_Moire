{"ast":null,"code":"/* eslint-disable */\nimport BaseLayout from '@/layouts/BaseLayout.vue';\nimport BaseFormText from '@/components/Base/BaseFormText.vue';\nimport BaseFormTextarea from '@/components/Base/BaseFormTextarea.vue';\nimport OrderDelivery from '@/components/Order/OrderDelivery.vue';\nimport OrderPayment from '@/components/Order/OrderPayment.vue';\nimport OrderItem from '@/components/Order/OrderItem.vue';\nimport numberFormat from '@/helpers/numberFormat';\nimport { mapState, mapGetters, mapActions } from 'vuex';\nexport default {\n  components: {\n    BaseLayout,\n    BaseFormText,\n    BaseFormTextarea,\n    OrderDelivery,\n    OrderPayment,\n    OrderItem\n  },\n  filters: {\n    numberFormat\n  },\n  data() {\n    return {\n      formData: {\n        name: '',\n        address: '',\n        phone: '',\n        email: '',\n        deliveryTypeId: 1,\n        paymentTypeId: 1,\n        comment: ''\n      },\n      deliveryPrice: '0'\n    };\n  },\n  computed: {\n    ...mapGetters('cart', {\n      products: 'cartDetailproducts',\n      totalPrice: 'cartTotalPrice'\n    }),\n    ...mapState('order', ['paymentTypes', 'deliveryTypes', 'orderSendingFailed', 'open', 'orderError', 'orderErrorMessage'])\n  },\n  watch: {\n    deliveryPrice: {\n      handler() {\n        this.changeOrderType();\n      }\n    }\n  },\n  created() {\n    this.changeOrderType();\n    this.loadDeliveryTypes();\n  },\n  methods: {\n    ...mapActions('order', ['loadPaymentTypes', 'loadDeliveryTypes', 'loadOrderData', 'closeModal']),\n    order() {\n      this.loadOrderData({\n        name: this.formData.name,\n        address: this.formData.address,\n        phone: this.formData.phone,\n        email: this.formData.email,\n        deliveryTypeId: this.formData.deliveryTypeId,\n        paymentTypeId: this.formData.paymentTypeId,\n        comment: this.formData.comment\n      });\n    },\n    changeOrderType() {\n      this.loadPaymentTypes({\n        deliveryTypeId: this.formData.deliveryTypeId\n      });\n    }\n  }\n};","map":{"version":3,"names":["BaseLayout","BaseFormText","BaseFormTextarea","OrderDelivery","OrderPayment","OrderItem","numberFormat","mapState","mapGetters","mapActions","components","filters","data","formData","name","address","phone","email","deliveryTypeId","paymentTypeId","comment","deliveryPrice","computed","products","totalPrice","watch","handler","changeOrderType","created","loadDeliveryTypes","methods","order","loadOrderData","loadPaymentTypes"],"sources":["src/pages/OrderPage.vue"],"sourcesContent":["<template>\n  <!-- eslint-disable  -->\n  <BaseLayout>\n    <main class=\"content container\">\n      <div class=\"content__top\">\n        <ul class=\"breadcrumbs\">\n          <li class=\"breadcrumbs__item\">\n            <router-link class=\"breadcrumbs__link\" :to=\"{ name: 'main' }\">\n              Каталог\n            </router-link>\n          </li>\n          <li class=\"breadcrumbs__item\">\n            <router-link class=\"breadcrumbs__link\" :to=\"{ name: 'cart' }\">\n              Корзина\n            </router-link>\n          </li>\n          <li class=\"breadcrumbs__item\">\n            <a class=\"breadcrumbs__link\">\n              Оформление заказа\n            </a>\n          </li>\n        </ul>\n\n        <div class=\"content__row\">\n          <h1 class=\"content__title\">\n            Оформление заказа\n          </h1>\n        </div>\n      </div>\n\n      <section class=\"cart\">\n        <form class=\"cart__form form\" action=\"#\" method=\"POST\" @submit.prevent=\"order\">\n          <div class=\"cart__field\">\n            <div class=\"cart__data\">\n              <BaseFormText v-model=\"formData.name\" :error=\"orderError.name\" title=\"ФИО\"\n                placeholder=\"Введите ваше полное имя\" id=\"name\" type=\"text\" maxlength=\"70\" />\n\n              <BaseFormText v-model=\"formData.address\" :error=\"orderError.address\" title=\"Адрес доставки\"\n                placeholder=\"Введите ваш адрес\" id=\"address\" type=\"text\" maxlength=\"200\" />\n\n              <BaseFormText v-model=\"formData.phone\" :error=\"orderError.phone\" title=\"Телефон\"\n                placeholder=\"Введите ваш телефон\" id=\"phone\" type=\"tel\" maxlength=\"12\" v-mask=\"'+7##########'\" />\n\n              <BaseFormText v-model=\"formData.email\" :error=\"orderError.email\" title=\"Email\"\n                placeholder=\"Введите ваш Email\" id=\"email\" type=\"email\" maxlength=\"70\" />\n\n              <BaseFormTextarea v-model=\"formData.comment\" :error=\"orderError.comment\" title=\"Комментарий к заказу\"\n                placeholder=\"Ваши пожелания\" id=\"comment\" maxlength=\"500\" />\n            </div>\n\n            <div class=\"cart__options\">\n              <h3 class=\"cart__title\">Доставка</h3>\n              <OrderDelivery :deliveryTypes=\"deliveryTypes\" :deliveryTypeId.sync=\"formData.deliveryTypeId\"\n                :deliveryPrice.sync=\"deliveryPrice\" />\n\n              <h3 class=\"cart__title\">Оплата</h3>\n              <OrderPayment :paymentTypes=\"paymentTypes\" :paymentTypeId.sync=\"formData.paymentTypeId\" />\n            </div>\n          </div>\n\n          <div class=\"cart__block\">\n            <ul class=\"cart__orders\">\n              <OrderItem v-for=\"item in products\" :key=\"item.productId\" :item=\"item\" />\n            </ul>\n\n            <div class=\"cart__total\">\n              <p>Доставка: <b>{{ deliveryPrice }} ₽</b></p>\n              <p>Итого товаров: <b>{{ products.length }}</b> на сумму <b>{{ (Number(totalPrice) + Number(deliveryPrice)) |\n                numberFormat }} ₽</b></p>\n            </div>\n\n            <button class=\"cart__button button button--primery\" type=\"submit\" v-if=\"products.length > 0\">\n              Оформить заказ\n            </button>\n          </div>\n          <vue-modaltor :visible=\"open\" @hide=\"closeModal\" :show-close-button=\"false\">\n          <div class=\"cart__error form__error-block\" style=\"text-align:center;\">\n            <h4>Ошибка при отправке заказа!</h4>\n            <p v-if=\"orderSendingFailed\">\n              {{ orderErrorMessage }}\n            </p>\n          </div>\n        </vue-modaltor>\n        </form>\n      </section>\n    </main>\n  </BaseLayout>\n</template>\n\n<script>\n/* eslint-disable */\nimport BaseLayout from '@/layouts/BaseLayout.vue';\nimport BaseFormText from '@/components/Base/BaseFormText.vue';\nimport BaseFormTextarea from '@/components/Base/BaseFormTextarea.vue';\nimport OrderDelivery from '@/components/Order/OrderDelivery.vue';\nimport OrderPayment from '@/components/Order/OrderPayment.vue';\nimport OrderItem from '@/components/Order/OrderItem.vue';\nimport numberFormat from '@/helpers/numberFormat';\nimport { mapState, mapGetters, mapActions } from 'vuex';\n\nexport default {\n  components: {\n    BaseLayout, BaseFormText,\n    BaseFormTextarea, OrderDelivery,\n    OrderPayment, OrderItem\n  },\n  filters: {\n    numberFormat,\n  },\n  data() {\n    return {\n      formData: {\n        name: '',\n        address: '',\n        phone: '',\n        email: '',\n        deliveryTypeId: 1,\n        paymentTypeId: 1,\n        comment: '',\n      },\n      deliveryPrice: '0',\n    };\n  },\n  computed: {\n    ...mapGetters('cart', {\n      products: 'cartDetailproducts',\n      totalPrice: 'cartTotalPrice',\n    }),\n    ...mapState('order', [\n      'paymentTypes',\n      'deliveryTypes',\n      'orderSendingFailed',\n      'open',\n      'orderError',\n      'orderErrorMessage',\n    ]),\n  },\n  watch: {\n    deliveryPrice: {\n      handler() {\n        this.changeOrderType();\n      },\n    },\n  },\n  created() {\n    this.changeOrderType();\n    this.loadDeliveryTypes();\n  },\n  methods: {\n    ...mapActions('order', [\n      'loadPaymentTypes',\n      'loadDeliveryTypes',\n      'loadOrderData',\n      'closeModal',\n    ]),\n    order() {\n      this.loadOrderData({\n        name: this.formData.name,\n        address: this.formData.address,\n        phone: this.formData.phone,\n        email: this.formData.email,\n        deliveryTypeId: this.formData.deliveryTypeId,\n        paymentTypeId: this.formData.paymentTypeId,\n        comment: this.formData.comment,\n      });\n    },\n    changeOrderType() {\n      this.loadPaymentTypes({ deliveryTypeId: this.formData.deliveryTypeId });\n    },\n  },\n};\n</script>\n"],"mappings":"AA0FA;AACA,OAAAA,UAAA;AACA,OAAAC,YAAA;AACA,OAAAC,gBAAA;AACA,OAAAC,aAAA;AACA,OAAAC,YAAA;AACA,OAAAC,SAAA;AACA,OAAAC,YAAA;AACA,SAAAC,QAAA,EAAAC,UAAA,EAAAC,UAAA;AAEA;EACAC,UAAA;IACAV,UAAA;IAAAC,YAAA;IACAC,gBAAA;IAAAC,aAAA;IACAC,YAAA;IAAAC;EACA;EACAM,OAAA;IACAL;EACA;EACAM,KAAA;IACA;MACAC,QAAA;QACAC,IAAA;QACAC,OAAA;QACAC,KAAA;QACAC,KAAA;QACAC,cAAA;QACAC,aAAA;QACAC,OAAA;MACA;MACAC,aAAA;IACA;EACA;EACAC,QAAA;IACA,GAAAd,UAAA;MACAe,QAAA;MACAC,UAAA;IACA;IACA,GAAAjB,QAAA,WACA,gBACA,iBACA,sBACA,QACA,cACA,oBACA;EACA;EACAkB,KAAA;IACAJ,aAAA;MACAK,QAAA;QACA,KAAAC,eAAA;MACA;IACA;EACA;EACAC,QAAA;IACA,KAAAD,eAAA;IACA,KAAAE,iBAAA;EACA;EACAC,OAAA;IACA,GAAArB,UAAA,WACA,oBACA,qBACA,iBACA,aACA;IACAsB,MAAA;MACA,KAAAC,aAAA;QACAlB,IAAA,OAAAD,QAAA,CAAAC,IAAA;QACAC,OAAA,OAAAF,QAAA,CAAAE,OAAA;QACAC,KAAA,OAAAH,QAAA,CAAAG,KAAA;QACAC,KAAA,OAAAJ,QAAA,CAAAI,KAAA;QACAC,cAAA,OAAAL,QAAA,CAAAK,cAAA;QACAC,aAAA,OAAAN,QAAA,CAAAM,aAAA;QACAC,OAAA,OAAAP,QAAA,CAAAO;MACA;IACA;IACAO,gBAAA;MACA,KAAAM,gBAAA;QAAAf,cAAA,OAAAL,QAAA,CAAAK;MAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}